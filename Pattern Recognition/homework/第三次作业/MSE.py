import numpy as np




train_data = np.array([[0.1,1.1,1],[6.8,7.1,1],[-3.5,-4.1,1],[2.0,2.7,1],[4.1,2.8,1],[3.1,5.0,1],[-0.8,-1.3,1],[0.9,1.2,1],
                       [7.1,4.2,1],[-1.4,-4.3,1],[4.5,0.0,1],[6.3,1.6,1],[4.2,1.9,1],[1.4,-3.2,1],[2.4,-4.0,1],[2.5,-6.1,1],
                       [-3.0,-2.9,1],[0.5,8.7,1],[2.9,2.1,1],[-0.1,5.2,1],[-4.0,2.2,1],[-1.3,3.7,1],[-3.4,6.2,1],[-4.1,3.4,1],
                       [-2.0,-8.4,1],[-8.9,0.2,1],[-4.2,-7.7,1],[-8.5,-3.2,1],[-6.7,-4.0,1],[-0.5,-9.2,1],[-5.3,-6.7,1],[-8.7,-6.4,1]]).astype(np.float32)
train_label = np.array([[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],
                        [0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],
                        [0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0],
                        [0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).astype(np.float32)

test_data = np.array([[5.0,6.4,1],[3.9,4.0,1],[8.4,3.7,1],[4.1,-2.2,1],[-5.1,1.6,1],[1.9,5.1,1],[-7.1,-9.7,1],[-8.0,-6.3,1]]).astype(np.float32)
test_label = np.array([[1,0,0,0],[1,0,0,0],[0,1,0,0],[0,1,0,0],[0,0,1,0],[0,0,1,0],[0,0,0,1],[0,0,0,1]]).astype(np.float32)


inv = np.linalg.inv(np.matmul(train_data.T,train_data))

w = np.matmul(np.matmul(inv,train_data.T),train_label)


pred = np.matmul(w.T,test_data.T)
column_maxes = np.max(pred, axis=0)
column_max_indices = np.argmax(pred, axis=0)
print(column_max_indices+1)